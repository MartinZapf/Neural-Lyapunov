# PID-SMC (3D PID-like SMC) - Best HPO Configuration
# Results: V = 5.2e-3 exclusion volume

seed: 42
deterministic: true

controller:
  name: pid_smc
  params:
    k1: 2.7
    k2: 5.345
    k3: 1.1
    delta_bound: 0.0

model:
  width: 256
  depth: 2
  eps_quad: 0.00022
  alpha_bar: 9.6e-05

gauge:
  input_dim: 3
  initial_radius: 0.054

alpha:
  alpha_x1: 0.042
  alpha_x2: 0.028
  alpha_x3: 0.029

box:
  train_x1: 4
  train_x2: 4
  train_x3: 4

ring:
  delta_rel: 0.054
  delta_abs: 0.105
  rel_frac: 0.30
  dist_eps: 0.05
  dist_gamma: 1.0
  detach_phi: true

sample:
  m_ring: 2048
  m_out_global: 16384
  m_size: 512

min_outside_batch: 0.2
far_outside_delta_min: 0.5
far_outside_delta_max: 2.0
expanded_box_scale: 1.5

train:
  epochs: 10000
  lr: 0.00094
  c_lower: 1.0e-4
  grad_target: 25.0
  grad_clip: 2.40
  dec_clip: 40.0
  s_eps_train: 0.0033

optim:
  lr: 0.00094
  weight_decay: 0.00021

val:
  N: 50
  every: 100
  tol_max: 0.0
  tol_q: 0.0
  s_eps_val: 1.0e-3

val_dtype: float64
val_min_outside_frac: 0.02
val_min_outside_count: 500

tail:
  mode: lse
  beta: 25.0
  topk_frac: 0.05

weights:
  w_plain_mean: 1.98
  w_plain_tail: 0.7
  w_ring: 0.44
  w_size_pre: 0.0
  w_size_post: 2.23
  w_floor: 0.1
  w_grad: 9.7e-05
  w_plain_before: 1.0
  w_plain_after: 0.7
  w_ang: 0.001

size:
  feas_patience: 4
  revoke_freeze: 3
  ramp_iters: 1123
  q: 0.95

polish:
  enable: true
  epochs: 500
  lr: 5.0e-05

viz:
  enable: true

io:
  outputs_root: outputs
